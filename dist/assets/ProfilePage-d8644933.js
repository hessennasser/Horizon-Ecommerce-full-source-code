import{r as i,c as be,u as we,A as ye,j as e,Q as d,a as J,b as q}from"./index-74d0d24f.js";import{a as le,b as te}from"./index.esm-747e09e3.js";import{j as $}from"./index.esm-c762f4ff.js";import{B as ne}from"./index.esm-bcb18170.js";import{B as re}from"./Breadcrumbs-77bbe042.js";import{S as _}from"./Tooltip-6d459ae5.js";import"./index-2a1aa769.js";import{S as Ne}from"./react-select.esm-4d872c73.js";import{u as oe}from"./user-image-placeholder-50f80e46.js";import"./iconBase-c989d1dc.js";import"./index.esm-396e9f6c.js";import"./floating-ui.dom.browser.min-b2afe59a.js";import"./index.esm-8bccb4d0.js";import"./toConsumableArray-399b6458.js";const De=()=>{const c=localStorage.getItem("userLogged"),u=JSON.parse(localStorage.getItem("userToken")),[o,y]=i.useState({}),N=localStorage.getItem("sellerLogged"),g=JSON.parse(localStorage.getItem("sellerToken")),[n,v]=i.useState({}),ie=be(),{i18n:a}=we(),{getUserInfo:C,getSallerInfo:P,logout:M,governorates:U,getGovernorates:ce}=i.useContext(ye);if(!c&&!N)return ie("/customer-login"),null;const[Q,L]=i.useState(!1),[V,I]=i.useState(!1),[m,de]=i.useState(!1),[l,R]=i.useState(!1),[D,S]=i.useState(!1),[p,B]=i.useState(c?o==null?void 0:o.name:n==null?void 0:n.name),[x,A]=i.useState(c?o==null?void 0:o.email:n==null?void 0:n.email),[h,z]=i.useState(c?o==null?void 0:o.phone:n==null?void 0:n.phone),[f,ue]=i.useState(n==null?void 0:n.cash_number),[j,ge]=i.useState(""),[b,me]=i.useState(""),[he,pe]=i.useState(""),k=()=>{de(!m)},E=()=>{R(!l),S(!1)},F=()=>{S(!D),R(!1)},H=s=>{B(s.target.value)},G=s=>{A(s.target.value)},K=s=>{z(s.target.value)},xe=s=>{ue(s.target.value)},W=s=>{ge(s.target.value)},X=s=>{me(s.target.value)},O=async s=>{s.preventDefault(),L(!0);const t=/^(?:01)(?:0|1|2|5)[0-9]{8}$/;if(!t.test(h)||!t.test(formData.phoneNumber)||!t.test(f)||!t.test(formData.phoneNumber)){d.error(a.language==="en"?"Invalid Egyptian phone number":"رقم هاتف مصري غير صالح"),L(!1);return}try{const w={token:c?u:g,name:p,email:x,phone:h,governorate_id:l?he:n.governorate_id,cash_number:f},ve=await J.post(`${q}${c?"/auth/user-update":"/vendor/auth/vendor-update"}`,w);d.success(a.language==="en"?"The profile updated successfully":"تم تحديث الملف الشخصي بنجاح")}catch{d.error(a.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مره اخري")}finally{L(!1),R(!1),c?C(u,y):P(g,v)}},T=async s=>{if(s.preventDefault(),!j){d.info(a.language==="en"?"please enter new password":"ادخل كلمة المرور الجديده");return}if(!b){d.info(a.language==="en"?"please enter confirmation password":"ادخل تاكيد كلمة المرور");return}if(j!==b){d.info(a.language==="en"?"password and confirmation password not match":"كلمة المرور وتاكيد كلمة المرور غير متطابقين");return}I(!0);try{const t={token:c?u:g,name:p,phone:h,email:x,governorate_id:n.governorate_id,cash_number:f,password:j,password_confirmation:b},w=await J.post(`${q}${c?"/auth/user-update":"/vendor/auth/vendor-update"}`,t);d.success("The password updated successfully")}catch{d.error(a.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مره اخري")}finally{I(!1),S(!1),c?C(u,y):P(g,v)}},Y=i.useRef(null),[r,Z]=i.useState(null),ee=s=>{const t=s.target.files[0];Z({...r,photo:t})},ae=async s=>{s.preventDefault();const t={token:c?u:g,image:r.photo,name:p,phone:h,email:x,governorate_id:n.governorate_id,cash_number:f};try{const w=await J.post(`${q}${c?"/auth/user-update":"/vendor/auth/vendor-update"}`,t,{headers:{"Content-Type":"multipart/form-data"}});d.success(a.language==="en"?"The photo updated successfully":"تم تحديث الصورة بنجاح")}catch{d.error(a.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مره اخري")}finally{I(!1),S(!1),c?C(u,y):P(g,v)}},se=()=>{Z({...r,photo:null})};i.useEffect(()=>{c&&C(u,y,B,A,z)},[c,u]),i.useEffect(()=>{N&&P(g,v,B,A,z)},[N,g]);const fe=U.map(s=>({value:s.id,label:s.title.en})),je=U.map(s=>({value:s.id,label:s.title.ar}));if(i.useEffect(()=>{ce()},[]),c)return e.jsxs("div",{className:"container py-10",children:[e.jsx("div",{className:"mb-10",children:e.jsx(re,{})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 my-5",children:[e.jsxs("div",{className:"user-info col-span-3 md:col-span-1 bg-white p-3 shadow-lg rounded-md h-fit",children:[e.jsxs("div",{className:"grid mb-3",children:[r!=null&&r.photo?e.jsx(e.Fragment,{children:e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:URL.createObjectURL(r==null?void 0:r.photo),alt:"Transfer photo",className:"h-full w-full"})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:o.image?`https://admin.horriizon.com/public/assets/${o.image}`:oe,className:"h-full w-full",alt:o.name})}),e.jsx("label",{htmlFor:"photoInput",className:"flex flex-col items-center justify-center",children:e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor cursor-pointer",children:a.language==="en"?"Upload New Image":"تحديث الصورة"})}),e.jsx("input",{ref:Y,id:"photoInput",type:"file",accept:".jpg,.jpeg,.png",className:"hidden",onChange:ee})]}),(r==null?void 0:r.photo)&&e.jsx("div",{children:e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{type:"button",className:"bg-mainColor text-white py-1 px-2 rounded-lg mr-2",onClick:ae,children:a.language==="en"?"Save":"حفظ"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white py-1 px-2 rounded-lg",onClick:se,children:a.language==="en"?"Close":"اغلاق"})]})})]}),e.jsxs("div",{className:"info flex flex-col justify-center items-center gap-3",children:[e.jsx("h3",{children:o.name}),e.jsx("h3",{className:"text-sm md:text-md",children:o.email})]}),e.jsxs("div",{className:"actions mt-10 flex flex-col justify-center items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-2",onClick:E,children:[e.jsx($,{})," ",a.language==="en"?"Edit Profile":"تعديل بياناتك"]}),e.jsxs("button",{className:"flex items-center gap-2",onClick:F,children:[e.jsx($,{})," ",a.language==="en"?"Edit Password":"تغيير كلمة المرور"]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2",children:[e.jsx(ne,{}),a.language==="en"?"Logout":"تسجيل الخروج"]})]})]}),e.jsxs("div",{className:"col-span-3 md:col-span-2 bg-white p-3 shadow-lg rounded-md h-fit",children:[e.jsx("h2",{className:"text-xl font-medium",children:a.language==="ar"?"الملف الشخصي":"Profile"}),e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:O,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"name",children:a.language==="ar"?"الاسم":"Full Name"}),e.jsx("input",{className:"w-full bg-gray-300",id:"name",type:"text",value:l?p:o.name,readOnly:!l,onChange:s=>{l&&H(s)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"phone",children:a.language==="ar"?"رقم الهاتف":"Phone"}),e.jsx("input",{className:"w-full bg-gray-300",id:"phone",type:"tel",value:l?h:o.phone,readOnly:!l,onChange:s=>{l&&K(s)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"email",children:a.language==="ar"?"البريد الالكتروني":"Email"}),e.jsx("input",{className:"w-full bg-gray-300",id:"email",type:"email",value:l?x:o.email,readOnly:!l,onChange:s=>{l&&G(s)}})]}),l&&e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:O,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:Q?e.jsx(_,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ التعديلات":"Save Changes"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:E,children:a.language==="ar"?"الغاء":"Cancel"})]})]}),D&&e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:T,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"new-password",children:a.language==="ar"?"كلمة المرور الجديده":"New Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"new-password",type:m?"text":"password",value:j,onChange:W}),m?e.jsx(le,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:k}):e.jsx(te,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:k})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"confirm-password",children:a.language==="ar"?"اعد كتابة كلمة المرور":"Confirm Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"confirm-password",type:m?"text":"password",value:b,onChange:X})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:T,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:V?e.jsx(_,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ كلمة المرور":"Uptade Password"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:F,children:a.language==="ar"?"الغاء":"Cancel"})]})]})]})]})]});if(N){const s=U.find(t=>t.id===n.governorate_id);return e.jsxs("div",{className:"container py-10",children:[e.jsx("div",{className:"mb-10",children:e.jsx(re,{})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 my-5",children:[e.jsxs("div",{className:"user-info col-span-3 md:col-span-1 bg-white p-3 shadow-lg rounded-md h-fit",children:[e.jsxs("div",{className:"grid mb-3",children:[r!=null&&r.photo?e.jsx(e.Fragment,{children:e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:URL.createObjectURL(r==null?void 0:r.photo),alt:"Transfer photo",className:"h-full w-full"})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:o.image?`https://admin.horriizon.com/images/${o.image}`:oe,className:"h-full w-full",alt:o.name})}),e.jsx("label",{htmlFor:"photoInput",className:"flex flex-col items-center justify-center",children:e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor cursor-pointer",children:a.language==="en"?"Upload New Image":"تحديث الصورة"})}),e.jsx("input",{ref:Y,id:"photoInput",type:"file",accept:".jpg,.jpeg,.png",className:"hidden",onChange:ee})]}),(r==null?void 0:r.photo)&&e.jsx("div",{children:e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{type:"button",className:"bg-mainColor text-white py-1 px-2 rounded-lg mr-2",onClick:ae,children:a.language==="en"?"Save":"حفظ"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white py-1 px-2 rounded-lg",onClick:se,children:a.language==="en"?"Close":"اغلاق"})]})})]}),e.jsxs("div",{className:"info flex flex-col justify-center items-center gap-3",children:[e.jsx("h3",{children:n.name}),e.jsx("h3",{className:"text-sm md:text-md",children:n.email})]}),e.jsxs("div",{className:"actions mt-10 flex flex-col justify-center items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-2",onClick:E,children:[e.jsx($,{})," ",a.language==="en"?"Edit Profile":"تعديل بياناتك"]}),e.jsxs("button",{className:"flex items-center gap-2",onClick:F,children:[e.jsx($,{})," ",a.language==="en"?"Edit Password":"تغيير كلمة المرور"]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2",children:[e.jsx(ne,{}),a.language==="en"?"Logout":"تسجيل الخروج"]})]})]}),e.jsxs("div",{className:"col-span-3 md:col-span-2 bg-white p-3 shadow-lg rounded-md h-fit",children:[e.jsx("h2",{className:"text-xl font-medium",children:a.language==="ar"?"الملف الشخصي":"Profile"}),e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:O,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"name",children:a.language==="ar"?"الاسم":"Full Name"}),e.jsx("input",{className:"w-full bg-gray-300",id:"name",type:"text",value:l?p:n.name,readOnly:!l,onChange:t=>{l&&H(t)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"phone",children:a.language==="ar"?"رقم الهاتف":"Phone"}),e.jsx("input",{className:"w-full bg-gray-300",id:"phone",type:"tel",value:l?h:n.phone,readOnly:!l,onChange:t=>{l&&K(t)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"email",children:a.language==="ar"?"البريد الالكتروني":"Email"}),e.jsx("input",{className:"w-full bg-gray-300",id:"email",type:"email",value:l?x:n.email,readOnly:!l,onChange:t=>{l&&G(t)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"cashNumber",children:a.language==="ar"?"رقم المحفظة الالكترونية":"Cash Number"}),e.jsx("input",{className:"w-full bg-gray-300",id:"cashNumber",type:"tel",value:l?f:n.cash_number,readOnly:!l,onChange:t=>{l&&xe(t)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"email",children:a.language==="ar"?"المحافظة":"Governorate"}),l?e.jsx(Ne,{name:"governorate",id:"governorate",className:"rounded-lg border-gray-300 shadow-md col-span-2",onChange:t=>pe(t.value),options:a.language==="en"?fe:je,placeholder:a.language==="ar"?"ادخل محافظتك":"enter your Governorate",isRtl:a.language==="ar",readOnly:!l,isSearchable:!0,required:!0}):e.jsx("input",{className:"w-full bg-gray-300",id:"governorate",type:"text",value:a.language==="en"?s==null?void 0:s.title.en:s==null?void 0:s.title.ar,readOnly:!l,onChange:t=>{l&&G(t)}})]}),l&&e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:O,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:Q?e.jsx(_,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ التعديلات":"Save Changes"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:E,children:a.language==="ar"?"الغاء":"Cancel"})]})]}),D&&e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:T,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"new-password",children:a.language==="ar"?"كلمة المرور الجديده":"New Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"new-password",type:m?"text":"password",value:j,onChange:W}),m?e.jsx(le,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:k}):e.jsx(te,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:k})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"confirm-password",children:a.language==="ar"?"اعد كتابة كلمة المرور":"Confirm Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"confirm-password",type:m?"text":"password",value:b,onChange:X})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:T,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:V?e.jsx(_,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ كلمة المرور":"Uptade Password"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:F,children:a.language==="ar"?"الغاء":"Cancel"})]})]})]})]})]})}};export{De as default};
